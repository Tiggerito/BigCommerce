<script data-cfasync="false">   
/*
    Web Site Advantage: Advanced Shipping Services [v1.0] 
    Adds advanced shipping service rules to the product markup
    https://bigcommerce.websiteadvantage.com.au/rich-snippets/
    Copyright (C) 2023 Web Site Advantage
*/

// This is a template that can be used to add shipping services to a product pages structured data

!function(){

    var offerId = '#Offer'; // This should be the @id for the Offer JSON-LD that the page already contains

    // This needs modifying to get your product information from your CMS. Gather any data that is needed to determine the shipping services for this product
    var product = {
        price: %%price%%, 
        priceCurrency: '%%priceCurrency%%', 
        weight: %%weight%%, 
        width: %%width%%,
        height: %%height%%, 
        depth: %%depth%%,
        fixedShippingPrice: %%fixedShippingPrice%%, 
        fixedShippingCurrency: '%%fixedShippingCurrency%%'
    };

    shippingItems = [];

    // create your own code to add appropriate shipping items to be used to build the structured data

    // Example item format with comments
    // shippingItems.push({
    // 
    //     // The cost of shipping to the specified destination. One of cost or maxCost is required
    //     cost: 0,
    //     maxCost: 10,
    //     currency: "USD",
    //
    //     // Country is required. 2 letter country codes. Can specify more than one.
    //     country: ["US"],
    //     // region or postal codes are optional. Don't use both. 
    //     region: ["NY"], // 2 or 3 letter codes. Currently supported in US, Australia, and Japan. Can specify more than one.
    //     postalCode: ["5000"], // currently supported in Australia, Canada, and the US. Can specify more than one.
        //
    //     // Required. The typical delay in days between the receipt of the order and the goods leaving the warehouse.
    //     handlingTimeMinDays: 0, 
    //     handlingTimeMaxDays: 0,
    //
    //     // Required. The typical delay in days between when the order has been sent for delivery and when the goods reach the final customer.
    //     transitTimeMinDays: 0,
    //     transitTimeMaxDays: 0
    // });

    // End of settings --------------------------------

    // Start of code that builds the Structured Data. You should not need to edit any of this 

    var shippingDetails = [];

    for (var i = 0; i < shippingItems.length; i++) {
        var item = shippingItems[i];

        var shippingRate = {"@type": "MonetaryAmount"};
        if (item.maxCost !== 'undefined') shippingRate.maxValue = item.maxCost;
        if (item.cost !== 'undefined') shippingRate.value = item.cost;
        if (item.currency) shippingRate.currency = item.currency;

        var shippingDestination = {"@type": "DefinedRegion"};
        if (item.country) shippingDestination.addressCountry = item.country;
        if (item.region) shippingDestination.addressRegion = item.region;
        if (item.postalCode) shippingDestination.postalCode = item.postalCode;

        var handlingTime = {"@type": "QuantitativeValue", "unitCode": "DAY"};
        if (item.handlingTimeMinDays !== 'undefined') handlingTime.minValue = item.handlingTimeMinDays;
        if (item.handlingTimeMaxDays !== 'undefined') handlingTime.maxValue = item.handlingTimeMaxDays;

        var transitTime = {"@type": "QuantitativeValue", "unitCode": "DAY"};
        if (item.transitTimeMinDays !== 'undefined') transitTime.minValue = item.transitTimeMinDays;
        if (item.transitTimeMaxDays !== 'undefined') transitTime.maxValue = item.transitTimeMaxDays;

        shippingDetails.push({
            "@type": "OfferShippingDetails",
            "shippingRate": shippingRate,
            "shippingDestination": shippingDestination,
            "deliveryTime": {
                "@type": "ShippingDeliveryTime",
                "handlingTime": handlingTime,
                "transitTime": transitTime
            }
        });
    }

    var offer = {
        "@context":"https://schema.org",
        "@id": offerId,
        "shippingDetails": shippingDetails
    };

    var script = document.createElement('script');
    script.id = 'wsa-rich-snippets-jsonld-offer-shipping';
    script.setAttribute('type', 'application/ld+json');
    script.textContent = JSON.stringify(offer);
    document.head.appendChild(script);
}();
</script>